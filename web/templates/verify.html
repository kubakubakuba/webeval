{% extends "base.html" %}

{% block title %}
Verify
{% endblock title %}

{% block content %}
<div class="card">
	<div class="card-body">
		<form method="post" id="verifyForm">
			<div class="form-group">
				<label for="username">Username:</label>
				<input type="text" id="username" name="username" class="form-control" required>
			</div>
			<!--<div class="form-group">
				<label for="email">Email:</label>
				<input type="email" id="email" name="email" class="form-control" required>
			</div>-->
			<div class="form-group">
				<label for="verification">Verification Number:</label>
				<div id="verification" class="d-flex center">
					{% for i in range(4) %}
					<input type="text" id="verification{{i}}" name="verification{{i}}" class="form-control verification-input" maxlength="2" required>
					{% endfor %}
				</div>
			</div>
			<div class="card card-btn col-sm-4 mx-auto mt-4" onclick="document.getElementById('verifyForm').submit();">
				<div class="card-body text-center">
					Verify
				</div>
			</div>
		</form>
	</div>
</div>

<style>
.verification-input {
	width: 75px;
	height: 75px;
	text-align: center;
	font-size: 1.75em;
	line-height: 75px;
	margin-right: 5px;
}
#verification {
	justify-content: center;
}
</style>

<script>
	const inputs = Array.from(document.querySelectorAll('#verification input'));
	inputs.forEach((input, i) => {
		input.addEventListener('input', () => {
			// Convert input to uppercase
			input.value = input.value.toUpperCase();

			// Remove non-alphanumeric characters
			input.value = input.value.replace(/[^A-Z0-9]/ig, "");

			if (input.value.length === 2) {
				if (i < inputs.length - 1) inputs[i + 1].focus();
			}
		});
		input.addEventListener('keydown', (e) => {
			if (e.key === 'Backspace' && !input.value && i > 0) {
				inputs[i - 1].focus();
			}
		});
	});
</script>
{% endblock content %}